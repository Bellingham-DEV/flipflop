<section class="flipflop container-fluid">
  <h1>Feature Flipflop</h1>

  <table class="table table-striped">
    <thead class="thead-inverse">
      <tr>
        <th></th>
        <th class="name">Feature</th>
        <th class="description">Description</th>
        <% @feature_set.strategies.each do |strategy| -%>
          <th data-toggle="tooltip" data-placement="top" title="<%= strategy.description -%>">
            <%= strategy.name.humanize -%>
          </th>
        <% end -%>
      </tr>
    </thead>
    <tbody>
    <% @feature_set.features.each do |feature| -%>
      <tr data-feature="<%= feature.name.dasherize %>">
        <td class="status" style="width: 2rem; font-size: 1.1rem;">
          <span style="width: 2rem" class="label label-pill label-<%= @feature_set.status(feature) == "on" ? "success" : "default" -%>"><%= @feature_set.status(feature) -%></span>
        </td>
        <td class="name" style="min-width: 10rem; padding-top: 0.9rem;"><strong><%= feature.name.humanize -%></strong></td>
        <td class="description" style="padding-top: 0.9rem; width: 20rem"><%= feature.description -%></td>

        <% @feature_set.strategies.each do |strategy| -%>
          <td data-strategy="<%= strategy.name.dasherize %>" style="min-width: 10.5rem;">
            <div class="btn-toolbar" role="toolbar">
              <%= form_tag(@feature_set.switch_url(strategy, feature), method: :put) do -%>
                <div class="btn-group btn-group-sm" role="group">
                  <%= submit_tag "on",
                    type: "submit",
                    class: ["btn", "btn-sm",
                      @feature_set.strategy_status(strategy, feature) == "on" ? "btn-primary" : "btn-secondary",
                    ],
                    disabled: strategy.switchable? ? false : true
                  -%>

                  <%= submit_tag "off",
                    type: "submit",
                    class: ["btn", "btn-sm",
                      @feature_set.strategy_status(strategy, feature) == "off" ? "btn-primary" : "btn-secondary",
                    ],
                    disabled: strategy.switchable? ? false : true
                  -%>
                </div>
              <% end -%>

              <% if strategy.switchable? -%>
                <div class="btn-group btn-group-sm" role="group">
                  <% unless @feature_set.strategy_status(strategy, feature).blank? -%>
                    <%= form_tag(@feature_set.switch_url(strategy, feature), method: :delete) do -%>
                      <%= submit_tag "clear",
                        type: "submit",
                        class: ["btn", "btn-secondary", "btn-sm"]
                      -%>
                    <% end -%>
                  <% end -%>
                </div>
              <% end -%>
            </div>
          </td>
        <% end -%>
      </tr>
    <% end -%>
    </tbody>
  </table>
</div>
